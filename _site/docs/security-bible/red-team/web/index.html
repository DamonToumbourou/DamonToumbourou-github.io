<!DOCTYPE html><html lang="en-US"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><link rel="stylesheet" href="/notes/assets/css/just-the-docs-default.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-2709176-10"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-2709176-10', { 'anonymize_ip': true }); </script> <script src="/notes/assets/js/vendor/lunr.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mermaid@9.1.6/dist/mermaid.min.js"></script> <script src="/notes/assets/js/just-the-docs.js"></script><meta name="viewport" content="width=device-width, initial-scale=1"><title>Web | Just the Docs</title><meta name="generator" content="Jekyll v4.3.1" /><meta property="og:title" content="Web" /><meta property="og:locale" content="en_US" /><meta name="description" content="A Jekyll theme for documentation" /><meta property="og:description" content="A Jekyll theme for documentation" /><link rel="canonical" href="http://localhost:4000/notes/docs/security-bible/red-team/web/" /><meta property="og:url" content="http://localhost:4000/notes/docs/security-bible/red-team/web/" /><meta property="og:site_name" content="Just the Docs" /><meta property="og:type" content="website" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Web" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"A Jekyll theme for documentation","headline":"Web","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/notes/assets/images/damon-toumbourou.png"}},"url":"http://localhost:4000/notes/docs/security-bible/red-team/web/"}</script><link rel="shortcut icon" href="/notes/favicon.ico" type="image/x-icon"><body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"><title>Link</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"><title>Search</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"><title>Menu</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"><title>Expand</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"><title>Document</title><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"><path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><title id="svg-external-link-title">(external link)</title><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> </svg><div class="side-bar"><div class="site-header"> <a href="/notes/" class="site-title lh-tight"><div class="site-logo"></div></a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a></div><nav aria-label="Main" id="site-nav" class="site-nav"><ul class="nav-list"><li class="nav-list-item"><a href="/notes/" class="nav-list-link">Home</a><li class="nav-list-item active"><a href="#" class="nav-list-expander" aria-label="toggle links in Security Bible category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/notes/docs/security-bible" class="nav-list-link">Security Bible</a><ul class="nav-list "><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in Forensics category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/notes/docs/security-bible/forensics" class="nav-list-link">Forensics</a><ul class="nav-list"><li class="nav-list-item "> <a href="/notes/docs/security-bible/forensics/windows/windows/" class="nav-list-link">Windows Endpoint</a><li class="nav-list-item "> <a href="/notes/docs/security-bible/forensics/lateral-movement/" class="nav-list-link">Lateral Movement</a><li class="nav-list-item "> <a href="/notes/docs/security-bible/forensics/network/network/" class="nav-list-link">Network Forensics</a></ul><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in Incident Response category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/notes/docs/security-bible/incident-response" class="nav-list-link">Incident Response</a><ul class="nav-list"></ul><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in Networking category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/notes/docs/security-bible/networking" class="nav-list-link">Networking</a><ul class="nav-list"></ul><li class="nav-list-item "><a href="/notes/docs/security-bible/standards/standards/" class="nav-list-link">Standards</a><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in Blue Team category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/notes/docs/security-bible/blue-team" class="nav-list-link">Blue Team</a><ul class="nav-list"><li class="nav-list-item "> <a href="/notes/docs/security-bible/blue-team/blue-team-tips" class="nav-list-link">Blue Team Tips</a><li class="nav-list-item "> <a href="/notes/docs/security-bible/blue-team/commandline-scripts" class="nav-list-link">Commandline Scripts</a></ul><li class="nav-list-item "><a href="#" class="nav-list-expander" aria-label="toggle links in Malware Analysis category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/notes/docs/security-bible/malware-analysis" class="nav-list-link">Malware Analysis</a><ul class="nav-list"><li class="nav-list-item "> <a href="/notes/docs/security-bible/malware-analysis/malicious-documents/" class="nav-list-link">Malicious Documents</a></ul><li class="nav-list-item active"><a href="#" class="nav-list-expander" aria-label="toggle links in Red Team category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/notes/docs/security-bible/forensics" class="nav-list-link">Red Team</a><ul class="nav-list"><li class="nav-list-item active"> <a href="/notes/docs/security-bible/red-team/web/" class="nav-list-link active">Web</a></ul></ul><li class="nav-list-item"><a href="#" class="nav-list-expander" aria-label="toggle links in Blog Posts category"> <svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg> </a><a href="/notes/docs/blog" class="nav-list-link">Blog Posts</a><ul class="nav-list "></ul></ul><ul class="nav-list"><li class="nav-list-item external"> <a href="https://github.com/DamonToumbourou" class="nav-list-link external"> Toumbourou on GitHub <svg viewBox="0 0 24 24" aria-labelledby="svg-external-link-title"><use xlink:href="#svg-external-link"></use></svg> </a></ul></nav><footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</footer></div><div class="main" id="top"><div id="main-header" class="main-header"><div class="search"><div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Toumbourou" aria-label="Search Just the Docs" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label></div><div id="search-results" class="search-results"></div></div><nav aria-label="Auxiliary" class="aux-nav"><ul class="aux-nav-list"><li class="aux-nav-list-item"> <a href="//github.com/DamonToumbourou" class="site-button" > Damon Toumbourou on GitHub </a></ul></nav></div><div id="main-content-wrap" class="main-content-wrap"><nav aria-label="Breadcrumb" class="breadcrumb-nav"><ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="/notes/docs/security-bible">Security Bible</a><li class="breadcrumb-nav-list-item"><a href="/notes/docs/security-bible/forensics">Red Team</a><li class="breadcrumb-nav-list-item"><span>Web</span></ol></nav><div id="main-content" class="main-content" role="main"><h1 class="no_toc" id="web-attacks"> <a href="#web-attacks" class="anchor-heading" aria-labelledby="web-attacks"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Web Attacks</h1><h2 class="no_toc text-delta" id="table-of-contents"> <a href="#table-of-contents" class="anchor-heading" aria-labelledby="table-of-contents"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table of contents</h2><ol id="markdown-toc"><li><a href="#cross-site-scripting" id="markdown-toc-cross-site-scripting">Cross-Site Scripting</a><ol><li><a href="#definitions-of-xss" id="markdown-toc-definitions-of-xss">Definitions of XSS:</a><li><a href="#types-of-xss" id="markdown-toc-types-of-xss">Types of XSS:</a><li><a href="#xss-examples" id="markdown-toc-xss-examples">XSS Examples</a><ol><li><a href="#reflected-xss-attack-on-a-search-query" id="markdown-toc-reflected-xss-attack-on-a-search-query"><strong>Reflected XSS Attack on a Search query</strong></a><li><a href="#reflected-xss-attack-on-an-error-message" id="markdown-toc-reflected-xss-attack-on-an-error-message"><strong>Reflected XSS Attack on an Error Message</strong></a><li><a href="#stored-xss-example" id="markdown-toc-stored-xss-example"><strong>Stored XSS example</strong></a></ol></ol></ol><hr /><h2 id="cross-site-scripting"> <a href="#cross-site-scripting" class="anchor-heading" aria-labelledby="cross-site-scripting"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Cross-Site Scripting</h2><p>Cross-Site Scripting is also known as a client-side injection attack, which aims at executing malicious scripts on a victim’s web browser by injecting malicious code.</p><h3 id="definitions-of-xss"> <a href="#definitions-of-xss" class="anchor-heading" aria-labelledby="definitions-of-xss"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Definitions of XSS:</h3><p>Early on, two primary types of XSS were identified, Stored XSS and Reflected XSS. In 2005, Amit Klein defined a third type of XSS, which Amit coined DOM Based XSS. These 3 types of XSS are defined as follows:</p><ul><li><p><strong>Reflected</strong> XSS (AKA Non-Persistent or Type I): Reflected XSS occurs when user input is immediately returned by a web application in an error message, search result, or any other response that includes some or all of the input provided by the user as part of the request, without that data being made safe to render in the browser, and without permanently storing the user provided data. In some cases, the user provided data may never even leave the browser (see DOM Based XSS below).</p><li><p><strong>Stored</strong> XSS (AKA Persistent or Type II) Stored XSS generally occurs when user input is stored on the target server, such as in a database, in a message forum, visitor log, comment field, etc. And then a victim is able to retrieve the stored data from the web application without that data being made safe to render in the browser. With the advent of HTML5, and other browser technologies, we can envision the attack payload being permanently stored in the victim’s browser, such as an HTML5 database, and never being sent to the server at all.</p><li><p><strong>DOM Based</strong> XSS (AKA Type-0) As defined by Amit Klein, who published the first article about this issue [1], DOM Based XSS is a form of XSS where the entire tainted data flow from source to sink takes place in the browser, i.e., the source of the data is in the DOM, the sink is also in the DOM, and the data flow never leaves the browser. For example, the source (where malicious data is read) could be the URL of the page (e.g., document.location.href), or it could be an element of the HTML, and the sink is a sensitive method call that causes the execution of the malicious data (e.g., document.write).”</p></ul><h3 id="types-of-xss"> <a href="#types-of-xss" class="anchor-heading" aria-labelledby="types-of-xss"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Types of XSS:</h3><p>For years, most people thought of these (Stored, Reflected, DOM) as three different types of XSS, but in reality, they overlap. You can have both Stored and Reflected DOM Based XSS. You can also have Stored and Reflected Non-DOM Based XSS too, but that’s confusing, so to help clarify things, starting about mid 2012, the research community proposed and started using two new terms to help organize the types of XSS that can occur:</p><ul><li><strong>Server XSS</strong> Server XSS occurs when untrusted user supplied data is included in an HTTP response generated by the server. The source of this data could be from the request, or from a stored location. As such, you can have both Reflected Server XSS and Stored Server XSS.</ul><p>In this case, the entire vulnerability is in server-side code, and the browser is simply rendering the response and executing any valid script embedded in it.</p><ul><li><strong>Client XSS</strong> Client XSS occurs when untrusted user supplied data is used to update the DOM with an unsafe JavaScript call. A JavaScript call is considered unsafe if it can be used to introduce valid JavaScript into the DOM. This source of this data could be from the DOM, or it could have been sent by the server (via an AJAX call, or a page load). The ultimate source of the data could have been from a request, or from a stored location on the client or the server. As such, you can have both Reflected Client XSS and Stored Client XSS.</ul><p>With these new definitions, the definition of DOM Based XSS doesn’t change. DOM Based XSS is simply a subset of Client XSS, where the source of the data is somewhere in the DOM, rather than from the Server.</p><p>Given that both Server XSS and Client XSS can be Stored or Reflected, this new terminology results in a simple, clean, 2 x 2 matrix with Client &amp; Server XSS on one axis, and Stored and Reflected XSS on the other axis as depicted in Dave Witchers’ DOM Based XSS talk</p><h3 id="xss-examples"> <a href="#xss-examples" class="anchor-heading" aria-labelledby="xss-examples"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> XSS Examples</h3><h4 id="reflected-xss-attack-on-a-search-query"> <a href="#reflected-xss-attack-on-a-search-query" class="anchor-heading" aria-labelledby="reflected-xss-attack-on-a-search-query"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Reflected XSS Attack on a Search query</strong></h4><p>Assume a web app accepts a search string from users through a search parameter within a query string:</p><div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">http://darwin.com/aform.html?search=Hacker1</span>

</code></pre></div></div><p>In the event the application server uses PHP to show the user-supplied value on the results page by pulling it from the URL and then generating the resulting HTML:</p><div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">&lt;?php echo 'You Searched:' .$_GET["search"];?&gt;</span>

</code></pre></div></div><p>The web server directly parses the user-supplied value in the URL to HTML with no input validation or output encoding. In such instances, attackers can craft arbitrary code that is executed in the browser when the victim clicks on the URL:</p><div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">http://darwin.com/aform.html?search=&lt;script&gt;alert('XSS by Product1');&lt;/script&gt;</span>
</code></pre></div></div><p>This script gives hackers access to the user’s session cookie and allows them to assume a legitimate user’s identity.</p><h4 id="reflected-xss-attack-on-an-error-message"> <a href="#reflected-xss-attack-on-an-error-message" class="anchor-heading" aria-labelledby="reflected-xss-attack-on-an-error-message"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Reflected XSS Attack on an Error Message</strong></h4><p>Suppose a web page accepts an input parameter that contains the text displayed in an error message and displays it directly within its response. In that case, attackers use such vulnerabilities to orchestrate XSS attacks.</p><p>Assuming the URL that returns the error message as:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>http://darwin.com/error/5/Error.ashx?message=Sorry%20+some+error+message
</code></pre></div></div><p>The returned error page directly copies the values of the URL’s message parameter then displays it suitably within the page:</p><div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">&lt;p&gt;Sorry, some error message&lt;/&gt;</span>
</code></pre></div></div><p>Without sanitization or appropriate validation, attackers can create a malicious payload to generate a pop-up screen:</p><div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">http://darwin.com/error/5/Error.ashx?message=&lt;script&gt;alert("XSS by Hacker1")&lt;/script&gt;</span>
</code></pre></div></div><p>If an unsuspecting user requests this page, the browser executes the malicious script, redirecting the user to an HTML page with the following content in place of the actual content:</p><div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">&lt;p&gt;&lt;scrRipt&gt;alert("XSS by Hacker1");&lt;/script&gt;&lt;/p&gt;</span>

</code></pre></div></div><h4 id="stored-xss-example"> <a href="#stored-xss-example" class="anchor-heading" aria-labelledby="stored-xss-example"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <strong>Stored XSS example</strong></h4><p>Suppose a website allows users to submit comments on blog posts, which are displayed to other users. Users submit comments using an HTTP request like the following:</p><div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">POST /post/comment HTTP/1.1</span>
<span class="na">Host</span><span class="pi">:</span> <span class="s">vulnerable-website.com</span>
<span class="na">Content-Length</span><span class="pi">:</span> <span class="m">100</span>

<span class="s">postId=3&amp;comment=This+post+was+extremely+helpful.&amp;name=Carlos+Montoya&amp;email=carlos%40normal-user.net</span>
</code></pre></div></div><p>After this comment has been submitted, any user who visits the blog post will receive the following within the application’s response:</p><div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">&lt;p&gt;This post was extremely helpful.&lt;/p&gt;</span>
</code></pre></div></div><p>Assuming the application doesn’t perform any other processing of the data, an attacker can submit a malicious comment like this:</p><div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">&lt;script&gt;/* Bad stuff here... */&lt;/script&gt;</span>
</code></pre></div></div><p>Within the attacker’s request, this comment would be URL-encoded as:</p><div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">comment=%3Cscript%3E%2F*%2BBad%2Bstuff%2Bhere...%2B*%2F%3C%2Fscript%3E</span>
</code></pre></div></div><p>Any user who visits the blog post will now receive the following within the application’s response:</p><div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s">&lt;p&gt;&lt;script&gt;/* Bad stuff here... */&lt;/script&gt;&lt;/p&gt;</span>
</code></pre></div></div><hr /><hr><footer><p><a href="#top" id="back-to-top">Back to top</a></p><p class="text-small text-grey-dk-100 mb-0">Notes collated by Damon Toumbourou. Distributed by an <a href="https://github.com/just-the-docs/just-the-docs/tree/main/LICENSE.txt">MIT license.</a> <a href="https://www.netlify.com/">This site is powered by Netlify.</a></p><div class="d-flex mt-2"><p class="text-small text-grey-dk-000 mb-0"> <a href="https://github.com/DamonToumbourou/notes/tree/main/docs/security-bible/red-team/web.md" id="edit-this-page">Find this page on GitHub</a></p></div></footer></div></div><div class="search-overlay"></div></div><script> var config = {} ; mermaid.initialize(config); window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid')); </script>
